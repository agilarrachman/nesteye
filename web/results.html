<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NestEye - Detection Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- QR Code library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Add Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Add Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <style>
        /* Base styles and typography */
        body {
            font-family: 'Poppins', sans-serif;
            color: #333;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

            /* Icon styling */
        .icon-img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        /* Adjust list items to align icons properly */
        .threats-list li, .tips-list li {
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

            /* Leaflet map styling */
        .leaflet-map {
            height: 400px;
            width: 100%;
            border-radius: 8px;
            z-index: 1;
        }
        
        .map-container {
            margin: 25px 0;
        }
        
        .map-attribution {
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.05);
            text-align: right;
            font-size: 0.8rem;
            color: #7f8c8d;
            border-radius: 0 0 8px 8px;
        }
            
        h1, h2, h3, h4, h5 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            color: #2ecd6d;
        }
        
        /* Full width styles */
        .container {
            width: 100%;
            max-width: 100%;
            padding: 0;
            margin: 0;
        }
        
        /* Header styling */
        .header {
            padding: 15px 30px;
            width: 100%;
            box-sizing: border-box;
            background-color: #ffffff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-left {
            display: flex;
            align-items: center;
        }
        
        .logo-container {
            width: 50px;
            height: 50px;
            margin-right: 15px;
        }
        
        .header-logo {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .header-text h1 {
            margin: 0;
            font-size: 1.8rem;
            color: #3498db;
        }
        
        .header-text p {
            margin: 0;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .header-nav ul {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        .header-nav li {
            margin-left: 25px;
        }
        
        .header-nav a {
            text-decoration: none;
            color: #34495e;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .header-nav a:hover {
            color: #3498db;
        }
        
        /* Content area */
        .content {
            width: 100%;
            padding: 0;
            background-color: #f8f9fa;
        }
        
        .results-container {
            width: 100%;
            max-width: 100%;
            padding: 30px;
            box-sizing: border-box;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2rem;
            color: #2c3e50;
            position: relative;
            padding-bottom: 15px;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(to right, #3498db, #2ecc71);
            border-radius: 3px;
        }
        
        /* Styles untuk menampilkan hanya satu card */
        .detection-results {
            display: flex;
            justify-content: center;
            width: 100%;
        }
        
        .result-card {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto 40px;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            overflow: hidden;
            background-color: #ffffff;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        /* Sembunyikan card pertama (ringkasan) */
        .result-card:not(.highest-confidence) {
            display: none;
        }
        
        /* Memperbesar ukuran gambar dan menyesuaikan layout header */
        .result-header {
            padding: 35px 40px;
            display: flex;
            align-items: flex-start;
            gap: 35px;
            background: linear-gradient(to right, rgba(52, 152, 219, 0.05), rgba(46, 204, 113, 0.05));
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .result-image {
            width: 280px;
            height: 280px;
            flex-shrink: 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border: 4px solid white;
        }
        
        .result-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .result-image img:hover {
            transform: scale(1.05);
        }
        
        .result-basic-info {
            flex: 1;
            padding-top: 10px;
        }
        
        .bird-name {
            font-size: 2.4rem;
            margin: 0 0 5px;
            color: #2c3e50;
        }
        
        .scientific-name {
            font-style: italic;
            color: #7f8c8d;
            margin: 0 0 20px;
            font-size: 1.1rem;
        }
        
        /* Confidence meter styling */
        .confidence-meter {
            margin: 25px 0;
        }
        
        .confidence-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 500;
            color: #34495e;
        }
        
        .confidence-bar-wrapper {
            height: 12px;
            background-color: #ecf0f1;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .confidence-bar {
            height: 100%;
            width: 0;
            background: linear-gradient(to right, #3498db, #2ecc71);
            border-radius: 6px;
            transition: width 1.5s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.5s;
            opacity: 0;
        }
        
        /* Alternative species styling */
        .alternative-species {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(241, 196, 15, 0.1);
            border-left: 4px solid #f1c40f;
            border-radius: 4px;
        }
        
        .alternative-species p {
            margin: 0;
            color: #7f8c8d;
        }
        
        .alternative-species strong {
            color: #34495e;
        }
        
        /* Tab styling */
        .conservation-details {
            padding: 0;
        }
        
        .info-tabs {
            display: flex;
            overflow-x: auto;
            padding: 0 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            scrollbar-width: none; /* Firefox */
        }
        
        .info-tabs::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }
        
        .tab-btn {
            padding: 15px 25px;
            background: none;
            border: none;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            color: #7f8c8d;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            position: relative;
            outline: none;
        }
        
        .tab-btn:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 3px;
            background: linear-gradient(to right, #3498db, #2ecc71);
            transition: width 0.3s;
            border-radius: 3px 3px 0 0;
        }
        
        .tab-btn:hover {
            color: #3498db;
        }
        
        .tab-btn.active {
            color: #2c3e50;
            font-weight: 600;
        }
        
        .tab-btn.active:after {
            width: 80%;
        }
        
        .tab-content {
            padding: 30px 40px;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Status badges styling */
        .status-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .status-badge {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-label {
            font-weight: 500;
            color: #34495e;
        }
        
        .status-value {
            font-weight: 600;
        }
        
        .status-terancam {
            color: #e74c3c;
        }
        
        .iucn-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            font-weight: 600;
            font-size: 0.8rem;
            margin-right: 8px;
        }
        
        .endangered {
            background-color: #e74c3c;
        }
        
        .critically-endangered {
            background-color: #c0392b;
        }
        
        .vulnerable {
            background-color: #e67e22;
        }
        
        /* Info grid styling */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-item {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .info-label {
            display: block;
            font-weight: 500;
            color: #34495e;
            margin-bottom: 5px;
        }
        
        .info-value {
            color: #7f8c8d;
        }
        
        /* Audio section styling */
        .audio-section {
            margin-top: 25px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .play-audio-btn {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .play-audio-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        .play-audio-btn:active {
            transform: translateY(1px);
        }
        
        /* Threats tab styling */
        .threats-list {
            padding: 0;
            list-style: none;
        }
        
        .threats-list li {
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .threats-list li i {
            color: #e74c3c;
            font-size: 1.2rem;
            width: 25px;
            text-align: center;
        }
        
        .threat-description {
            margin-top: 25px;
            padding: 20px;
            background-color: rgba(231, 76, 60, 0.05);
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
        }
        
        /* Habitat tab styling */
        .map-container {
            margin: 25px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .habitat-map-img {
            width: 100%;
            display: block;
        }
        
        .map-attribution {
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.05);
            text-align: right;
            font-size: 0.8rem;
            color: #7f8c8d;
        }
        
        .habitat-description {
            margin-top: 20px;
            line-height: 1.7;
        }
        
        /* Conservation action tab styling */
        .tips-list {
            padding: 0;
            list-style: none;
        }
        
        .tips-list li {
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .tips-list li i {
            color: #2ecc71;
            font-size: 1.2rem;
            width: 25px;
            text-align: center;
        }
        
        .conservation-links {
            margin-top: 30px;
        }
        
        .conservation-links h5 {
            margin-bottom: 15px;
            color: #34495e;
        }
        
        .conservation-links ul {
            padding-left: 20px;
        }
        
        .conservation-links a {
            color: #3498db;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .conservation-links a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        /* Gallery tab styling */
        .photo-gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .gallery-item {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        
        .gallery-item:hover {
            transform: translateY(-5px);
        }
        
        .gallery-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }
        
        /* Share tab styling */
        .share-section {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
        }
        
        .share-buttons-container, .qr-code-container {
            flex: 1;
            min-width: 300px;
        }
        
        .share-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .share-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 30px;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .whatsapp {
            background-color: #25D366;
        }
        
        .instagram {
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
        }
        
        .twitter {
            background-color: #1DA1F2;
        }
        
        .icons-attribution {
            margin-top: 30px;
            text-align: center;
        }
        
        .attribution-text {
            font-size: 0.8rem;
            color: #95a5a6;
        }
        
        .attribution-text a {
            color: #3498db;
            text-decoration: none;
        }
        
        .attribution-text a:hover {
            text-decoration: underline;
        }
        
        /* Adjust share buttons to align icons properly */
        .share-btn img {
            margin-right: 5px;
            vertical-align: middle;
        }
        
        .qr-code {
            margin: 20px 0;
            display: flex;
            justify-content: center;
        }
        
        .qr-code img {
            border: 10px solid white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .download-qr-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
            margin: 0 auto;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .download-qr-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        .qr-info {
            text-align: center;
            color: #7f8c8d;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        /* Action buttons styling */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }
        
        .back-btn, .detect-again-btn {
            padding: 12px 30px;
            border-radius: 30px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .back-btn {
            background-color: #ecf0f1;
            color: #34495e;
            border: 1px solid #bdc3c7;
        }
        
        .detect-again-btn {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .back-btn:hover {
            background-color: #dfe6e9;
            transform: translateY(-2px);
        }
        
        .detect-again-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
                
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header, .results-container, .tab-content, .footer {
                padding: 15px;
            }
            
            .result-header {
                padding: 20px 15px;
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .result-image {
                width: 200px;
                height: 200px;
            }
            
            .bird-name {
                font-size: 1.8rem;
            }
            
            .info-tabs {
                padding: 0 10px;
            }
            
            .tab-btn {
                padding: 12px 15px;
                font-size: 0.9rem;
            }
            
            .status-badges {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        /* Additional responsive improvements */
        @media (min-width: 1200px) {
            .info-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .photo-gallery-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

                /* Threats tab styling */
        .threats-list {
            padding: 0;
            list-style: none;
        }

        .threats-list li {
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .threats-list li i {
            color: #e74c3c;
            font-size: 1.2rem;
            width: 25px;
            text-align: center;
        }

        /* Conservation action tab styling */
        .tips-list {
            padding: 0;
            list-style: none;
        }

        .tips-list li {
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .tips-list li i {
            color: #2ecc71;
            font-size: 1.2rem;
            width: 25px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header content remains unchanged -->
        <header class="header">
            <div class="header-left">
                <div class="logo-container">
                    <img src="{{ url_for('static', filename='images/nesteye.png') }}" alt="NestEye Logo" class="header-logo">
                </div>
                <div class="header-text">
                    <h1>NestEye</h1>
                    <p>Advanced Bird Species Detection & Classification</p>
                </div>
            </div>
            <nav class="header-nav">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/#about-section">Tentang Kami</a></li>
                    <li><a href="/#detection-section">Deteksi</a></li>
                </ul>
            </nav>
        </header>

        <!-- Rest of the content remains the same -->
        <div class="content">
            <div class="results-container">
                <h2 class="section-title">Hasil Deteksi</h2>
                
                    <div class="detection-results">
                        {% for crop in crops_data %}
                            {% if crop.is_highest %}
                            <div class="result-card highest-confidence">
                                <!-- Bird image and basic info section -->
                                <div class="result-header">
                                    <div class="result-image">
                                        <img src="{{ url_for('cropped_file', filename=crop.img) }}" alt="{{ crop.label }}">
                                    </div>
                                    <div class="result-basic-info">
                                        <h3 class="bird-name">{{ crop.label }}</h3>
                                        <p class="scientific-name">{% if crop.label == 'Kakatua Putih' %}(Cacatua alba){% elif crop.label == 'Elang Jawa' %}(Nisaetus bartelsi){% elif crop.label == 'Jalak Bali' %}(Leucopsar rothschildi){% elif crop.label == 'Nuri Hitam' %}(Chalcopsitta atra){% endif %}</p>
                                        <div class="confidence-meter">
                                            <div class="confidence-label">Keyakinan: {{ crop.confidence }}%</div>
                                            <div class="confidence-bar-wrapper">
                                                <div class="confidence-bar" data-width="{{ crop.confidence }}"></div>
                                            </div>
                                        </div>
                                        
                                        <!-- Alternative species suggestions if confidence is low -->
                                        {% if crop.confidence|float < 90 %}
                                        <div class="alternative-species">
                                            <p><strong>Kemungkinan lain:</strong> 
                                                {% if crop.label == 'Kakatua Putih' %}
                                                    Kakatua Jambul Kuning, Kakatua Raja
                                                {% elif crop.label == 'Elang Jawa' %}
                                                    Elang Brontok, Elang Ular Bido
                                                {% elif crop.label == 'Jalak Bali' %}
                                                    Jalak Suren, Jalak Putih
                                                {% elif crop.label == 'Nuri Hitam' %}
                                                    Nuri Kepala Hitam, Nuri Talaud
                                                {% endif %}
                                            </p>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                                
                                <!-- Detailed conservation information in tabs -->
                                <div class="conservation-details">
                                    <div class="info-tabs">
                                        <button class="tab-btn active" data-tab="status">Status & Populasi</button>
                                        <button class="tab-btn" data-tab="threats">Ancaman</button>
                                        <button class="tab-btn" data-tab="habitat">Habitat</button>
                                        <button class="tab-btn" data-tab="action">Aksi Konservasi</button>
                                        <button class="tab-btn" data-tab="share">Bagikan</button>
                                    </div>
                                    
                                    <div class="tab-content">
                                    <!-- ... existing code ... -->

    <!-- Status & Population Tab -->
    <div class="tab-pane active" id="status-tab">
        <div class="status-badges">
            <div class="status-badge">
                <span class="status-label">Status:</span>
                <span class="status-value status-terancam">Terancam</span>
            </div>
            
            <div class="status-badge">
                <span class="status-label">Status IUCN:</span>
                <span class="status-value">
                    {% if crop.label == 'Kakatua Putih' %}
                        <span class="iucn-badge endangered">EN</span> Endangered
                    {% elif crop.label == 'Elang Jawa' %}
                        <span class="iucn-badge endangered">EN</span> Endangered
                    {% elif crop.label == 'Jalak Bali' %}
                        <span class="iucn-badge critically-endangered">CR</span> Critically Endangered
                    {% elif crop.label == 'Nuri Hitam' %}
                        <span class="iucn-badge vulnerable">LC</span> Least Concern
                    {% endif %}
                </span>
            </div>
        </div>
        
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Populasi:</span>
                <span class="info-value">
                    {% if crop.label == 'Kakatua Putih' %}
                        Diperkirakan antara 42.500-183.000 individu pada awal 1990-an; mengalami penurunan hingga 70% sejak saat itu
                    {% elif crop.label == 'Elang Jawa' %}
                        Diperkirakan antara 600-1.000 individu dewasa
                    {% elif crop.label == 'Jalak Bali' %}
                        Kurang dari 100 individu di alam liar; populasi di penangkaran lebih dari 1.000 individu
                    {% elif crop.label == 'Nuri Hitam' %}
                        Belum ada data pasti; dianggap stabil di habitat aslinya
                    {% endif %}
                </span>
            </div>
            <div class="info-item">
                <span class="info-label">Catatan:</span>
                <span class="info-value">
                    {% if crop.label == 'Kakatua Putih' %}
                        Dilindungi melalui CITES Appendix II dan undang-undang nasional
                    {% elif crop.label == 'Elang Jawa' %}
                        Spesies endemik Pulau Jawa yang sangat dilindungi
                    {% elif crop.label == 'Jalak Bali' %}
                        Simbol konservasi nasional Indonesia dan maskot Provinsi Bali
                    {% elif crop.label == 'Nuri Hitam' %}
                        Endemik Papua dan pulau-pulau sekitarnya
                    {% endif %}
                </span>
            </div>
        </div>
        
        <!-- ... existing audio section ... -->
    </div>

    <!-- Threats Tab -->
    <div class="tab-pane" id="threats-tab">
        <h4>Ancaman Utama</h4>
        <ul class="threats-list">
            {% if crop.label == 'Kakatua Putih' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Perdagangan ilegal untuk pasar burung peliharaan</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Kehilangan habitat akibat deforestasi dan perubahan penggunaan lahan</li>
            {% elif crop.label == 'Elang Jawa' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Perusakan dan fragmentasi habitat hutan di Jawa</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Perburuan liar untuk perdagangan ilegal</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Gangguan dari aktivitas manusia di habitatnya</li>
            {% elif crop.label == 'Jalak Bali' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Perburuan ilegal untuk perdagangan burung</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Kehilangan habitat akibat deforestasi</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Predasi oleh hewan liar dan domestik</li>
            {% elif crop.label == 'Nuri Hitam' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Perdagangan ilegal sebagai burung peliharaan</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-error-60.png') }}" alt="Warning" class="icon-img"> Kehilangan habitat akibat penebangan hutan</li>
            {% endif %}
        </ul>
        
        <div class="threat-description">
            <p>
                {% if crop.label == 'Kakatua Putih' %}
                    Populasi Kakatua Putih terus menurun akibat perdagangan ilegal dan kehilangan habitat. Sejak awal 1990-an, populasi diperkirakan telah menurun hingga 70%.
                {% elif crop.label == 'Elang Jawa' %}
                    Elang Jawa menghadapi ancaman serius dari fragmentasi habitat dan perburuan liar. Sebagai spesies endemik Pulau Jawa, kelangsungan hidupnya sangat bergantung pada perlindungan hutan yang tersisa.
                {% elif crop.label == 'Jalak Bali' %}
                    Jalak Bali adalah salah satu burung paling terancam di dunia dengan kurang dari 100 individu tersisa di alam liar. Perburuan ilegal dan kehilangan habitat telah membawa spesies ini ke ambang kepunahan.
                {% elif crop.label == 'Nuri Hitam' %}
                    Meskipun populasinya dianggap stabil, Nuri Hitam tetap menghadapi ancaman dari perdagangan ilegal dan penebangan hutan di habitat aslinya di Papua.
                {% endif %}
            </p>
        </div>
    </div>

<!-- Habitat Tab -->
<div class="tab-pane" id="habitat-tab">
    <div class="info-item">
        <span class="info-label">Habitat:</span>
        <span class="info-value">
            {% if crop.label == 'Kakatua Putih' %}
                Hutan hujan tropis di Maluku Utara, Indonesia
            {% elif crop.label == 'Elang Jawa' %}
                Hutan pegunungan di Pulau Jawa, Indonesia
            {% elif crop.label == 'Jalak Bali' %}
                Hutan monsun kering di Bali Barat, Indonesia
            {% elif crop.label == 'Nuri Hitam' %}
                Hutan tropis di Papua dan pulau-pulau sekitarnya
            {% endif %}
        </span>
    </div>
    
    <div class="info-item">
        <span class="info-label">Sebaran:</span>
        <span class="info-value">
            {% if crop.label == 'Kakatua Putih' %}
                Endemik di Kepulauan Maluku Utara, Indonesia, termasuk pulau-pulau seperti Halmahera, Bacan, Ternate, Tidore, Kasiruta, dan Mandioli.
            {% elif crop.label == 'Elang Jawa' %}
                Hanya ditemukan di Pulau Jawa, Indonesia, terutama di hutan-hutan primer dan sekunder di pegunungan seperti Taman Nasional Gunung Halimun Salak dan Taman Nasional Bromo Tengger Semeru.
            {% elif crop.label == 'Jalak Bali' %}
                Endemik di Pulau Bali, terutama di bagian barat laut seperti Taman Nasional Bali Barat dan Pulau Nusa Penida.
            {% elif crop.label == 'Nuri Hitam' %}
                Ditemukan di Papua Barat, Indonesia, termasuk pulau-pulau seperti Batanta, Salawati, dan sekitarnya.
            {% endif %}
        </span>
    </div>
    
    <div class="map-container">
        <h4>Peta Sebaran</h4>
        <div id="habitat-map-{{ crop.label|lower|replace(' ', '-') }}" class="leaflet-map"></div>
        <div class="map-attribution">
            Sumber: Data Konservasi Indonesia
        </div>
    </div>
    
    <div class="habitat-description">
        <p>
            {% if crop.label == 'Kakatua Putih' %}
                Kakatua Putih mendiami hutan hujan tropis dataran rendah dan perbukitan di Maluku Utara. Mereka bersarang di lubang pohon besar dan membutuhkan hutan yang masih utuh untuk bertahan hidup.
            {% elif crop.label == 'Elang Jawa' %}
                Elang Jawa hidup di hutan pegunungan Pulau Jawa pada ketinggian 500-3.000 meter. Mereka membutuhkan hutan primer yang luas dengan pohon-pohon tinggi untuk bersarang dan berburu.
            {% elif crop.label == 'Jalak Bali' %}
                Jalak Bali mendiami hutan monsun kering dan savana di bagian barat Pulau Bali. Habitat alaminya kini terbatas pada area Taman Nasional Bali Barat dan Pulau Nusa Penida.
            {% elif crop.label == 'Nuri Hitam' %}
                Nuri Hitam hidup di hutan hujan tropis dataran rendah dan perbukitan di Papua dan pulau-pulau sekitarnya. Mereka menyukai area dengan pepohonan tinggi untuk bersarang dan mencari makan.
            {% endif %}
        </p>
    </div>
</div>

    <!-- Conservation Action Tab -->
    <div class="tab-pane" id="action-tab">
        <h4>Upaya Konservasi</h4>
        <ul class="tips-list">
            {% if crop.label == 'Kakatua Putih' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Perlindungan hukum melalui CITES Appendix II dan undang-undang nasional</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Monitoring populasi dan habitat di Maluku Utara</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Kampanye edukasi untuk mengurangi permintaan pasar</li>
            {% elif crop.label == 'Elang Jawa' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Perlindungan habitat di taman nasional seperti Bromo Tengger Semeru dan Gunung Halimun Salak</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Monitoring populasi dan edukasi masyarakat lokal</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Penegakan hukum terhadap perburuan dan perdagangan ilegal</li>
            {% elif crop.label == 'Jalak Bali' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Program penangkaran dan pelepasliaran di Taman Nasional Bali Barat</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Penerapan hukum adat (awig-awig) di Nusa Penida untuk melindungi burung ini</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Edukasi dan pemberdayaan masyarakat lokal dalam konservasi</li>
            {% elif crop.label == 'Nuri Hitam' %}
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Perlindungan habitat alami di Papua dan pulau-pulau sekitarnya</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Pengawasan perdagangan satwa liar</li>
                <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Edukasi masyarakat tentang pentingnya konservasi spesies ini</li>
            {% endif %}
        </ul>
        
        <h4>Apa yang Bisa Kamu Lakukan</h4>
        <ul class="tips-list">
            <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Hindari membeli burung langka sebagai peliharaan</li>
            <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img"> Dukung organisasi konservasi yang melindungi habitatnya</li>
            <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Edukasi lingkungan sekitar tentang pentingnya pelestarian</li>
            <li><img src="{{ url_for('static', filename='icons/icons8-check-60.png') }}" alt="Checklist" class="icon-img">  Nikmati burung di alam liar melalui birdwatching</li>
        </ul>
        
        <!-- ... existing conservation links ... -->
    </div>
                                    
                                    <!-- Share Tab -->
                                    <div class="tab-pane" id="share-tab">
                                        <div class="share-section">
                                            <div class="share-buttons-container">
                                                <h4>Bagikan Temuan</h4>
                                                <div class="share-buttons">
                                                    <button class="share-btn whatsapp" onclick="shareToWhatsApp('{{ crop.label }}')">
                                                        <img src="https://img.icons8.com/color/24/000000/whatsapp.png" alt="WhatsApp icon"/> WhatsApp
                                                    </button>
                                                    <button class="share-btn instagram" onclick="shareToInstagram('{{ crop.label }}')">
                                                        <img src="https://img.icons8.com/fluency/24/000000/instagram-new.png" alt="Instagram icon"/> Instagram
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="icons-attribution">
                                                <p class="attribution-text">Icons by <a href="https://icons8.com" target="_blank">Icons8</a></p>
                                            </div>
                                            
                                            <div class="qr-code-container">
                                                <h4>QR Code</h4>
                                                <div class="qr-code" id="qrcode-{{ crop.label|lower|replace(' ', '-') }}"></div>
                                                <button class="download-qr-btn" onclick="downloadQRCode('{{ crop.label }}')">
                                                    <i class="fas fa-download"></i> Download QR
                                                </button>
                                                <p class="qr-info">Scan untuk informasi lebih lanjut</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
                
                <div class="action-buttons">
                    <a href="/" class="back-btn">Kembali ke Beranda</a>
                    <a href="/#detection-section" class="detect-again-btn">Deteksi Lagi</a>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="{{ url_for('static', filename='images/nesteye.png') }}" alt="NestEye Logo" class="footer-logo-img">
                    <h3>NestEye</h3>
                </div>
                <div class="footer-contact">
                    <h3>Contact</h3>
                    <p>Email: info@nesteye.com</p>
                    <p>Phone: +62 812 3456 7890</p>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2024 NestEye - Aplikasi Deteksi Burung Langka Indonesia</p>
                </div>
            </div>
        </footer>
        
        <!-- Add footer styling with light green background -->
        <style>
            .footer {
                background-color: #e8f5e9; /* Light green background */
                padding: 40px 0;
                margin-top: 60px;
                border-top: 4px solid #27ae60;
            }
            
            .footer-content {
                display: flex;
                flex-wrap: wrap;
                justify-content: space-between;
                align-items: flex-start;
                max-width: 1200px;
                margin: 0 auto;
                padding: 0 20px;
            }
            
            .footer-logo {
                display: flex;
                align-items: center;
                margin-bottom: 20px;
            }
            
            .footer-logo-img {
                width: 50px;
                height: 50px;
                margin-right: 15px;
            }
            
            .footer-logo h3 {
                font-size: 1.5rem;
                color: #27ae60;
                margin: 0;
            }
            
            .footer-contact h3 {
                font-size: 1.2rem;
                color: #333;
                margin-bottom: 15px;
            }
            
            .footer-contact p {
                margin: 5px 0;
                color: #555;
            }
            
            .footer-copyright {
                width: 100%;
                text-align: center;
                margin-top: 30px;
                padding-top: 20px;
                border-top: 1px solid rgba(39, 174, 96, 0.2);
                color: #666;
            }
            
            @media (max-width: 768px) {
                .footer-content {
                    flex-direction: column;
                    align-items: center;
                    text-align: center;
                }
                
                .footer-contact {
                    margin: 20px 0;
                }
            }
        </style>
    </div>

    <script>
        // Animate confidence bars on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const bars = document.querySelectorAll('.confidence-bar');
                bars.forEach(bar => {
                    const width = bar.getAttribute('data-width');
                    bar.style.width = width + '%';
                    bar.style.opacity = '1';
                });
            }, 300);
            
            // Initialize QR codes
            generateQRCodes();
            
            // Setup audio buttons
            setupAudioButtons();
            
            // Setup tabs functionality
            setupTabs();
        });
        
        // Tab functionality
        function setupTabs() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Get the tab container
                    const tabContainer = this.closest('.conservation-details');
                    
                    // Remove active class from all buttons in this container
                    tabContainer.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Hide all tab panes in this container
                    tabContainer.querySelectorAll('.tab-pane').forEach(pane => {
                        pane.classList.remove('active');
                    });
                    
                    // Show the selected tab pane
                    const tabName = this.getAttribute('data-tab');
                    tabContainer.querySelector(`#${tabName}-tab`).classList.add('active');
                });
            });
        }
        
      // Audio playback functionality
function setupAudioButtons() {
    const audioButtons = document.querySelectorAll('.play-audio-btn');
    let currentlyPlaying = null;
    
    audioButtons.forEach(button => {
        button.addEventListener('click', function() {
            const birdId = this.getAttribute('data-bird');
            const audio = document.getElementById('audio-' + birdId);
            
            if (!audio) {
                console.error('Audio element not found for:', birdId);
                return;
            }
            
            // If there's another audio playing, stop it first
            if (currentlyPlaying && currentlyPlaying !== audio) {
                currentlyPlaying.pause();
                currentlyPlaying.currentTime = 0;
                
                // Reset the button for the previously playing audio
                const prevButton = document.querySelector(`[data-bird="${currentlyPlaying.id.replace('audio-', '')}"]`);
                if (prevButton) {
                    prevButton.innerHTML = "<img src=\"{{ url_for('static', filename='icons/icons8-play-48.png') }}\" alt=\"Play\" class=\"icon-img\"> Putar Suara";
                }
            }
            
            // Handle this audio
            if (audio.paused) {
                // Make sure audio is fully loaded before playing
                audio.load();
                
                // Add a small delay before playing to ensure loading
                setTimeout(() => {
                    audio.play()
                        .then(() => {
                            // Playback started successfully
                            this.innerHTML = "<img src=\"{{ url_for('static', filename='images/icons/pause.png') }}\" alt=\"Pause\" class=\"icon-img\"> Jeda";
                            currentlyPlaying = audio;
                        })
                        .catch(error => {
                            console.error('Audio playback failed:', error);
                            alert('Gagal memutar audio. Pastikan file audio tersedia.');
                        });
                }, 100);
            } else {
                audio.pause();
                audio.currentTime = 0;
                this.innerHTML = "<img src=\"{{ url_for('static', filename='icons/icons8-play-48.png') }}\" alt=\"Play\" class=\"icon-img\"> Putar Suara";
                currentlyPlaying = null;
            }
            
            // Reset button when audio ends
            audio.onended = function() {
                button.innerHTML = "<img src=\"{{ url_for('static', filename='icons/icons8-play-48.png') }}\" alt=\"Play\" class=\"icon-img\"> Putar Suara";
                currentlyPlaying = null;
            };
        });
    });
}
        
        // Generate QR codes for each bird
        function generateQRCodes() {
            document.querySelectorAll('.qr-code').forEach(container => {
                const birdId = container.id.replace('qrcode-', '');
                const birdName = birdId.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                
                // Create QR code
                const qr = qrcode(0, 'M');
                qr.addData(`https://nesteye.domcloud.dev/species/${birdId}`);
                qr.make();
                
                // Render QR code
                container.innerHTML = qr.createImgTag(5);
            });
        }
        
        // Download QR code as image
        function downloadQRCode(birdName) {
            const birdId = birdName.toLowerCase().replace(/ /g, '-');
            const qrImg = document.querySelector(`#qrcode-${birdId} img`);
            
            // Create a temporary link
            const link = document.createElement('a');
            link.href = qrImg.src;
            link.download = `nesteye-${birdId}-qrcode.png`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Social media sharing functions
        function shareToWhatsApp(birdName) {
            const text = `Saya baru saja mendeteksi ${birdName} menggunakan NestEye! Burung ini termasuk spesies langka yang perlu kita lindungi. Coba NestEye sekarang: https://nesteye.com`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }
        
        function shareToInstagram(birdName) {
            alert('Untuk berbagi ke Instagram: Screenshot hasil deteksi, lalu unggah ke Instagram Story atau Feed Anda dengan tagar #NestEye #SaveBirds');
        }
        
        function shareToTwitter(birdName) {
            const text = `Saya baru saja mendeteksi ${birdName} menggunakan NestEye! Burung ini termasuk spesies langka yang perlu kita lindungi. #NestEye #SaveBirds`;
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
        }

        document.addEventListener('DOMContentLoaded', function() {
            // ... existing DOMContentLoaded code ...
            
            // Initialize maps when habitat tab is clicked
            const habitatTabButtons = document.querySelectorAll('.tab-btn[data-tab="habitat"]');
            habitatTabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Get the bird name from the closest result card
                    const resultCard = this.closest('.result-card');
                    const birdName = resultCard.querySelector('.bird-name').textContent;
                    
                    // Initialize map with a small delay to ensure the tab is visible
                    setTimeout(() => {
                        initializeMap(birdName);
                    }, 100);
                });
            });
        });
        
        // Initialize Leaflet map based on bird species
        function initializeMap(birdName) {
            const mapId = `habitat-map-${birdName.toLowerCase().replace(/ /g, '-')}`;
            const mapElement = document.getElementById(mapId);
            
            // If map is already initialized or element doesn't exist, return
            if (!mapElement || mapElement.getAttribute('data-initialized') === 'true') {
                return;
            }
            
            // Set map coordinates and zoom level based on bird species
            let centerCoords, zoomLevel, markers;
            
            switch(birdName) {
                case 'Elang Jawa':
                    centerCoords = [-7.5, 110.5]; // Central Java
                    zoomLevel = 8;
                    markers = [
                        {coords: [-6.7, 106.5], name: "Taman Nasional Gunung Halimun Salak"},
                        {coords: [-7.9, 112.9], name: "Taman Nasional Bromo Tengger Semeru"}
                    ];
                    break;
                    
                case 'Jalak Bali':
                    centerCoords = [-8.2, 114.9]; // Bali
                    zoomLevel = 9;
                    markers = [
                        {coords: [-8.1, 114.5], name: "Taman Nasional Bali Barat"},
                        {coords: [-8.7, 115.5], name: "Pulau Nusa Penida"}
                    ];
                    break;
                    
                case 'Nuri Hitam':
                    centerCoords = [-1.0, 130.0]; // Papua
                    zoomLevel = 7;
                    markers = [
                        {coords: [-0.8, 130.5], name: "Papua Barat"},
                        {coords: [-1.1, 130.8], name: "Pulau Batanta"},
                        {coords: [-1.0, 130.7], name: "Pulau Salawati"}
                    ];
                    break;
                    
                case 'Kakatua Putih':
                    centerCoords = [0.6, 127.5]; // North Maluku
                    zoomLevel = 8;
                    markers = [
                        {coords: [0.7, 127.9], name: "Pulau Halmahera"},
                        {coords: [0.6, 127.5], name: "Pulau Ternate"},
                        {coords: [0.7, 127.4], name: "Pulau Tidore"},
                        {coords: [-0.3, 127.5], name: "Pulau Bacan"},
                        {coords: [0.4, 127.6], name: "Pulau Kasiruta"},
                        {coords: [0.3, 127.5], name: "Pulau Mandioli"}
                    ];
                    break;
                    
                default:
                    centerCoords = [-2.5, 118.0]; // Indonesia
                    zoomLevel = 5;
                    markers = [];
            }
            
            // Initialize map
            const map = L.map(mapId).setView(centerCoords, zoomLevel);
            
            // Add OpenStreetMap tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            // Add markers for important locations
            markers.forEach(marker => {
                L.marker(marker.coords)
                    .addTo(map)
                    .bindPopup(marker.name);
            });
            
            // Add polygon to highlight distribution area
            let distributionArea;
            switch(birdName) {
                case 'Elang Jawa':
                    // Polygon roughly outlining Java
                    distributionArea = L.polygon([
                        [[-5.8, 105.2], [-5.9, 114.4], [-8.8, 114.5], [-8.7, 105.1]]
                    ], {color: '#e74c3c', fillOpacity: 0.2}).addTo(map);
                    break;
                    
                case 'Jalak Bali':
                    // Polygon roughly outlining Bali
                    distributionArea = L.polygon([
                        [[-8.0, 114.4], [-8.0, 115.7], [-8.9, 115.7], [-8.8, 114.4]]
                    ], {color: '#e74c3c', fillOpacity: 0.2}).addTo(map);
                    break;
                    
                case 'Nuri Hitam':
                    // Polygon roughly outlining Papua Bird's Head Peninsula
                    distributionArea = L.polygon([
                        [[-0.1, 129.0], [-0.1, 132.0], [-2.0, 132.0], [-2.0, 129.0]]
                    ], {color: '#e74c3c', fillOpacity: 0.2}).addTo(map);
                    break;
                    
                case 'Kakatua Putih':
                    // Polygon roughly outlining North Maluku
                    distributionArea = L.polygon([
                        [[2.0, 126.0], [2.0, 129.0], [-1.0, 129.0], [-1.0, 126.0]]
                    ], {color: '#e74c3c', fillOpacity: 0.2}).addTo(map);
                    break;
            }
            
            // Mark map as initialized
            mapElement.setAttribute('data-initialized', 'true');
            
            // Fix map display issues by triggering a resize after a short delay
            setTimeout(() => {
                map.invalidateSize();
            }, 100);
        }
    </script>
    
</body>
</html>